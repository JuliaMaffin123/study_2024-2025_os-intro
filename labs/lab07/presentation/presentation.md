---
## Front matter
lang: ru-RU
title: Лабораторная работа №7
subtitle: Анализ файловой системы Linux. Команды для работы с файлами и каталогами
author:
  - Полякова Ю.А.
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 28 февраля 2007

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Полякова Юлия Александровна
  * Студент
  * Российский университет дружбы народов
  * [yulya.polyakova.07@mail.ru](mailto:yulya.polyakova.07@mail.ru)
  * <https://github.com/JuliaMaffin123>

:::
::: {.column width="30%"}

![](./image/polyakova.jpg)

:::
::::::::::::::

# Вводная часть

## Актуальность

- Важно иметь базовые знания работы с файлами и каталогами

## Объект и предмет исследования

- Файловая система Linux

## Цели и задачи

- Ознакомление с файловой системой Linux, её структурой, именами и содержанием каталогов.
- Приобретение практических навыков по применению команд для работы с файлами и каталогами.
- Приобретение практических навыков по управлению процессами (и работами).
- Приобретение практических навыков по проверке использования диска и обслуживанию файловой системы.

## Материалы и методы

- Файловая система Linux
- Команды для работы с файлами и каталогами
- Командная строка в терминале

# Выполнение лабораторной работы

## Копирование файлов и каталогов

Выполним примеры на копирование файлов и каталогов. 1) touch abc1; cp abc1 april; cp abc1 may - копирование файла в текущем каталоге. 2) mkdir monthly; cp april may monthly - копирование нескольких файлов в каталог. 3) cp monthly/may monthly/june; ls monthly - копирование файлов в произвольном каталоге. 4) mkdir monthly.00; cp -r monthly monthly.00 - копирование каталогов в текущем каталоге. 5) cp -r monthly.00 /tmp - копирование каталогов в произвольном каталоге.

![Копирование файлов и каталогов](image/1.jpg){#fig:001 width=40%}

## Перемещение и переименование файлов и каталогов

Выполним примеры на перемещение и переименование файлов и каталогов. 1) mv april july - переименование файлов в текущем каталоге. 2) mv july monthly.00; ls monthly.00 - перемещение файлов в другой каталог. 3) mv monthly.00 monthly.01 - переименование каталогов в текущем каталоге. 4) mkdir reports; mv monthly.01 reports - перемещение каталога в другой каталог. 5) mv reports/monthly.01 reports/monthly - переименование каталога, не являющегося текущим.

![Перемещение и переименование файлов и каталогов](image/2.jpg){#fig:002 width=50%}

## Изменение прав доступа к файлам и каталогам 1-3

Выполним примеры изменения прав доступа к файлам и каталогам. 1) touch may; ls -l may; chmod u+x may; ls -l may - создаем файл ~/may с правом выполнения для владельца. 2) chmod u-x may; ls -l may - лишаем владельца файла ~/may права на выполнение. 3) mkdir monthly; chmod g-r,o-r monthly - создаем каталог monthly с запретом на чтение для членов группы и всех остальных пользователей.

![Изменение прав доступа к файлам и каталогам 1-3](image/3.jpg){#fig:003 width=30%}

## Изменение прав доступа к файлам и каталогам 4

Пример 4) touch abc1; chmod g+w abc1 - создаем файл ~/abc1 с правом записи для членов группы.

![Изменение прав доступа к файлам и каталогам 4](image/4.jpg){#fig:004 width=70%}

## Задания 2.1. - 2.4.

Задание 2.1. Скопируйте файл /usr/include/sys/io.h в домашний каталог и назовите его equipment. Команда: cp /usr/include/sys/io.h; mv io.h equipment.
Задание 2.2. В домашнем каталоге создайте директорию ~/ski.plases. Команда: mkdir ~/ski.plases
Задание 2.3. Переместите файл equipment в каталог ~/ski.plases. Команда: mkdir equipment ~/ski.plases
Задание 2.4. Переименуйте файл ~/ski.plases/equipment в ~/ski.plases/equiplist. Команда: mv ~/ski.plases/equipment ~/ski.plases/equiplist

![Задания 2.1. - 2.4.](image/5.jpg){#fig:005 width=60%}

## Задания 2.5. - 2.8.

Задание 2.5. Создайте в домашнем каталоге файл abc1 и скопируйте его в каталог ~/ski.plases, назовите его equiplist2.  Команда: touch abc1; cp abc1 ~/ski.plases; mv ~/ski.plases/abc1 ~/ski.plases/equiplist2
Задание 2.6. Создайте каталог с именем equipment в каталоге ~/ski.plases. Команда: mkdir ~/ski.plases/equipment
Задание 2.7. Переместите файлы ~/ski.plases/equiplist и equiplist2 в каталог ~/ski.plases/equipment. Команда: mv ~/ski.plases/equiplist ~/ski.plases/equiplist2 ~/ski.plases/equipment/
Задание 2.8. Создайте и переместите каталог ~/newdir в каталог ~/ski.plases и назовите его plans. Команда: mkdir newdir; mv newdir ~/ski.plases/plans

![Задания 2.5. - 2.8.](image/6.jpg){#fig:006 width=30%}

## Задания 3.1. - 3.4.

Определяем опции команды chmod, необходимые для того, чтобы присвоить перечисленным в условии файлам выделенные права доступа, считая, что в начале таких прав нет: 3.1. g-x,o-x; 3.2. g-r,o-r; 3.3. 544; 3.4. g+w

![Задания 3.1. - 3.4.](image/7.jpg){#fig:007 width=40%}

## Задания 4.1. - 4.5.

Задание 4.1. Просмотрите содержимое файла /etc/password. Команда: cat /etc/password
Задание 4.2. Скопируйте файл ~/feathers в файл ~/file.old. Команда: cp ~/feathers ~/file.old
Задание 4.3. Переместите файл ~/file.old в каталог ~/play. Команда: mv ~/file.old ~/play
Задание 4.4. Скопируйте каталог ~/play в каталог ~/fun. Команда: cp -r ~/play ~/fun/
Задание 4.5. Переместите каталог ~/fun в каталог ~/play и назовите его games. Команда: mv ~/fun ~/play/games

![Задания 4.1. - 4.5.](image/8.jpg){#fig:008 width=50%}

## Задания 4.6. - 4.9.

Задание 4.6. Лишите владельца файла ~/feathers права на чтение. Команда: chmod u-r ~/feathers
Задание 4.7. Что произойдёт, если вы попытаетесь просмотреть файл ~/feathers командой cat? Ответ: доступ будет запрещен
Задание 4.8. Что произойдёт, если вы попытаетесь скопировать файл ~/feathers? Ответ: доступ будет запрещен
Задание 4.9. Дайте владельцу файла ~/feathers право на чтение. Команда: chmod u+r ~/feathers

![Задания 4.6. - 4.9.](image/9.jpg){#fig:009 width=55%}

## Задания 4.10. - 4.12.

Задание 4.10. Лишите владельца каталога ~/play права на выполнение. Команда: chmod u-x ~/play
Задание 4.11. Перейдите в каталог ~/play. Что произошло? Команда: cd ~/play. Доступ был запрещен.
Задание 4.12. Дайте владельцу каталога ~/play право на выполнение. Команда: chmod u+x ~/play

![Задания 4.10. - 4.12.](image/10.jpg){#fig:010 width=60%}

## Документация mount

Команда man mount, mount - команда для монтирования файловых систем. Када файловая система монтируется она страновится доступной для чтения и записи в указанной точке монтирования. Пример: sudo mount /dev/sda1 /mnt - монтирует файловую систему на устройстве /dev/sda1 в точку /mnt

![Документация mount](image/11.jpg){#fig:011 width=50%}

## Документация fsck

Команда man fsck, fsck проверяет целостность файловой системы и исправляет обнаруженные ошибки. Пример: fsck -A - проверка ошибок во всех разделах системы

![Документация fsck](image/12.jpg){#fig:012 width=50%}

## Документация mkfs

Команда man mkfs, mkfs создает файловую систему. Пример: mkfs -t ext4 /dev/sda1 - создает файловую систему ext4 в разделе /dev/sda1

![Документация mkfs](image/13.jpg){#fig:013 width=50%}

## Документация kill

Команда man kill, kill - для завершения процессов вручную, посылает сигнал завершения выбранному процессу. Пример: kill 279 - чтобы остановить процесс с идентификатором 279

![Документация kill](image/14.jpg){#fig:014 width=50%}

# Контрольные вопросы

## Контрольные вопросы

1. Дайте характеристику каждой файловой системе, существующей на жёстком диске компьютера, на котором вы выполняли лабораторную работу.

Это btrfs и ext4. Файловая система BTRFS (B-Tree Filesystem) — это современная файловая система, разработанная для использования в операционных системах Linux. Она построена по принципу копирования при записи (Copy on Write): при чтении области данных используется общая копия, в случае изменения данных — создаётся новая копия.
Файловая система Ext4 — это собственная файловая система Linux, созданная для преодоления проблем Ext3. Она использует базовые принципы Ext3, но имеет ряд нововведений, например, увеличена скорость работы, увеличен максимальный размер файла и добавлена поддержка накопителей объёмом до 1 Экзабайта.

## Контрольные вопросы

2. Приведите общую структуру файловой системы и дайте характеристику каждой директории первого уровня этой структуры.

Btrfs: на низком уровне располагаются блочные устройства, далее идут метаданные и экстенты, адресация которых происходит уже на логическом уровне. На этом же уровне реализуется избыточность (аналог RAID 0, 1, 5, 6, 10). Предпоследний уровень — субтома (Subvolumes). На верхнем уровне находятся данные пользователя в обычном виде. Btrfs не использует суперблок и другие привычные элементы файловой системы.
Ext4: 1) Суперблок. Находится в самом начале файловой системы. 2) Глобальная таблица дескрипторов группы блоков. В ней описаны первый и последний блоки для каждой группы блоков. 3) Битовая карта блока. Это специальная таблица, где указано, какие блоки в группе использованы, а какие свободны. 4) Битовая карта inodes. Аналогична битовой карте блока, но с информацией о свободных inodes, которые могут быть использованы для записи новых файлов. 5) Блоки данных. Физические блоки памяти, с данными пользователя.

## Контрольные вопросы

3. Какая операция должна быть выполнена, чтобы содержимое некоторой файловой
системы было доступно операционной системе? Ответ: mount

## Контрольные вопросы

4. Назовите основные причины нарушения целостности файловой системы. Как устра-
нить повреждения файловой системы?

Некоторые основные причины нарушения целостности файловой системы в Linux: Случайное удаление файлов. Неисправности оборудования. Вредоносные программы и вирусы. Ошибка обновлений и настройка системы. Проблемы с логическими разделами и форматирование. Сбои в работе RAID-массивов. Ошибки пользователей при выполнении административных задач.

Для устранения повреждений файловой системы в Linux можно использовать утилиту fsck (File System Check). Она проверяет целостность файловой системы и исправляет обнаруженные ошибки. Некоторые рекомендации по использованию fsck: Делать резервные копии перед проверкой. Не запускать fsck на смонтированных разделах. Использовать флаг -n для первичного анализа.

## Контрольные вопросы

5. Как создаётся файловая система? Ответ: Файловая система в Linux создаётся с помощью команды mkfs. Она организует иерархию каталогов, подкаталогов и файлов на отформатированном запоминающем устройстве (разделе на жёстком диске, USB-накопителе или другом носителе информации).

## Контрольные вопросы

6. Дайте характеристику командам для просмотра текстовых файлов.

Некоторые команды для просмотра текстовых файлов в Linux и их характеристика: 1) cat. Выводит содержимое файла на экран. 2) nl. Действует аналогично команде cat, но выводит ещё и номера строк в столбце слева. 3) less. Выводит содержимое файла, но отображает его только в рамках текущего окна в режиме просмотра. Можно прокручивать текст файла клавишами стрелок или перелистывать страницы клавишами w и z. Чтобы выйти из режима просмотра используется клавиша q. 4) head. Выводит на экран только первые 10 строк файла. Используя опцию -n, можно задать количество строк, которое нужно вывести. 5) tail. Аналогична команде head, но выводит последние 10 строк файла. С помощью команды tail можно увидеть изменения, сделанные в файле в реальном времени.

## Контрольные вопросы

7. Приведите основные возможности команды cp в Linux.Ответ: 1) Рекурсивное копирование директорий со всем содержимым (опция -r или --recursive). 2) Подробный вывод информации о процессе копирования (опция -v или --verbose). 3) Запрос подтверждения перед копированием файлов (опция -i или --interactive). 4) Копирование только новых или обновлённых файлов (опция -u или --update). 5) Сохранение всех атрибутов файлов (владелец, права, временные метки) (опция -p или --preserve). 6) Создание резервной копии для существующих файлов (опция -b или --backup). 7) Принудительная перезапись существующих файлов назначения (опция -f). 8) Обработка разреженных файлов. По умолчанию cp создаёт разреженные файлы только если файл-источник разрежен, но можно настроить это поведение так, чтобы все файлы, содержащие последовательности нулей, делались разреженными (опция --sparse). 

## Контрольные вопросы

8. Приведите основные возможности команды mv в Linux. Ответ: 1) Перемещение файлов и каталогов из одного места в другое. Можно перемещать несколько файлов одновременно. 2) Переименование файлов и каталогов. Если в качестве аргументов заданы имена двух файлов, то имя первого файла будет изменено на имя второго. 3) Создание резервных копий существующих файлов, которые будут перезаписаны или удалены. 4) Перемещение отсутствующих в целевой директории файлов. Если в определённую директорию нужно переместить ряд файлов, однако некоторые из них уже имеются в данном каталоге, используется опция -n. 5) Подробный вывод информации о перемещаемых или переименовываемых файлах. Для этого используется опция -v. 6) Перемещение файлов на основе шаблона. С помощью команды mv можно перемещать файлы на основе расширения файлов или части имени файла. 

## Контрольные вопросы

9. Что такое права доступа? Как они могут быть изменены? Ответ: Права доступа в Linux — это система, которая регулирует взаимодействие пользователей с файлами и папками. Они устанавливают, кто имеет возможность читать (просматривать), изменять (записывать), выполнять (исполнять) файлы и программы. Чтобы изменить права доступа к файлу или папке в Linux, используется команда chmod. Она позволяет устанавливать или изменять права чтения, записи и выполнения для владельца файла, группы и остальных пользователей.

## Вывод

Мы ознакомились с файловой системой Linux, её структурой, именами и содержанием каталогов. Также приобрели практические навыки по применению команд для работы с файлами и каталогами, по управлению процессами (и работами), по проверке использования диска и обслуживанию файловой системы.
